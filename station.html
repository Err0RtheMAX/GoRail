<html>
  

<head>

  <!-- bootstrap 파일 불러오기 -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
  <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCawUvo6vhrdecSUeco460_j5BdXLbXirM&callback=initMap&libraries=&v=weekly"
    defer></script>

<script>
    function getApi($mapX, $mapY) {

      const $url = 'http://api.visitkorea.or.kr/openapi/service/rest/KorService/locationBasedList'

const $KEY = 'Y%2Fp5JLBmrkILvFkISB3Yp282tJ9n4Syw7T6U7rK5JjokV53hvlumKQOVZW%2FK9tGdJtL4HUW6IB1%2Bmr59et%2B9sQ%3D%3D'
// 미리 받은 인증 키
const $numOfRows = '10'
const $pageNo = '10'
const $MobileOS = 'WIN'
const $MobileApp = 'trainPortal'
const $arrange = 'E'
const $contentTypeId = '15'
const $radius = '10000'
const $listYN = 'Y'

const  $api_url = $url + '?serviceKey=' + $KEY + 
						'&numOfRows=' + $numOfRows + 
						'&pageNo=' + $pageNo + 
						'&MobileOS=' + $MobileOS + 
						'&MobileApp=' + $MobileApp + 
						'&arrange=' + $arrange + 
						'&contentTypeId=' + $contentTypeId + 
						'&radius=' + $radius + 
						'&listYN=' + $listYN + 
						'&mapX=' + $mapX + 
						'&mapY=' + $mapY;

            console.log($api_url);
            
            jQuery.ajax(
              { url : $api_url,
                dataType: "xml",
                success: function(data) {
                  var $items = $(data).find("items");
                  
                  $items.find("item").each(function() {

                    var $addr1 = $(this).find("addr1").text();
                    var $addr2 = $(this).find("addr2").text();

                    console.log($addr1);
                    console.log($addr2);



                    document.getElementById("detail").innerHTML = $addr1;
                  })
                }

              }
            );
  }

  let map;

  var getParameters = function (paramName) {
    // 리턴값을 위한 변수 선언
    var returnValue;

    // 현재 URL 가져오기
    var url = location.href;

    // get 파라미터 값을 가져올 수 있는 ? 를 기점으로 slice 한 후 split 으로 나눔
    var parameters = (url.slice(url.indexOf('?') + 1, url.length)).split('&');

    // 나누어진 값의 비교를 통해 paramName 으로 요청된 데이터의 값만 return
    for (var i = 0; i < parameters.length; i++) {
      var varName = parameters[i].split('=')[0];
      if (varName.toUpperCase() == paramName.toUpperCase()) {
        returnValue = parameters[i].split('=')[1];
        return decodeURIComponent(returnValue);
      }
    }
  };

  function station(req, res) {

    var name = getParameters('name');

    if (name == "부산") {
      return '35.11543560776758,129.04223226917358';
    } else if (name == "통영") {
      return '34.88518379783825,128.4169441180927';
    } else if (name == "경주") {
      return '35.84466079615989,129.21790345569565';
    } else if (name == "단양") {
      return '37.01916436494398,128.33858581421015';
    } else if (name == "강릉") {
      return '37.76401896414172,128.90163576922785';
    } else if (name == "울산") {
      return '35.55161428724902,129.13851672685396';
    } else if (name == "포항") {
      return '36.07196015278183,129.3419183538491';
    } else if (name == "영덕") {
      return '36.41103310776056,129.37728718454295';
    } else if (name == "울진") {
      return '36.98376867444184,129.3971215403755';
    } else if (name == "군산") {
      return '35.99947617825534,126.75978954035538';
    } else if (name == "전주") {
      return '35.850056958058765,127.16181945569575';
    } else if (name == "광주") {
      return '35.260286533439455,126.92534747510909';
    } else if (name == "순천") {
      return '34.94600883924083,127.50318489615485';
    } else if (name == "광주") {
      return '35.22582730698232,126.91483008425706';
    } else if (name == "여수") {
      return '34.75389006202851,127.74869419325849';
    } else if (name == "대구") {
      return '35.87625684854493,128.59600954035284';
    } else if (name == "안동") {
      return '36.56465859587872,128.73312024340967';
    } else if (name == "영월") {
      return '37.18266377085605,128.48073526921553';
    }
  }

  function initMap(name) {
    var latlng = station(name);

    var lat = parseFloat(latlng.split(',')[0]);
    var lng = parseFloat(latlng.split(',')[1]);

    map = new google.maps.Map(document.getElementById("map"), {
      center: { lat: lat, lng: lng },
      zoom: 16,
    });
  }

  var latlng = station(name);

    var lat = parseFloat(latlng.split(',')[0]);
    var lng = parseFloat(latlng.split(',')[1]);

  document.onload = getApi(lng,lat);

</script>
  
  <meta charset="utf-8">

  <style type="text/css">
    #map {
      float: right;
      width: 50%;
      height: 50%;
    }
  </style>




<body>
  <div id="detail"></div>
  <div id="map"></div>
</body>


</html>